---
title: "DS6372Project1"
author: "Andre Mauldin"
date: "1/24/2021"
output: html_document
---
### Project 1

### Libraries
```{r}
library(leaps)
library(magrittr) # makes the pipe %>% work
library(ggplot2)
library(tidyverse)
library(reshape2)
library(car)     # where vif function lives
library(ISLR)
library(leaps)
library(dplyr)
library(doBy)
library(e1071)
library(class)
library(caret)
library(Metrics)
```

### Data
```{r}
options(digits = 10, scipen = 2) # removes scientific notation and goes to 10 decimal places

CaseData = read.csv('data1.csv',header = T,sep = ",", stringsAsFactors = TRUE)
# view(CaseData) # shows the whole data set
head(CaseData) # shows the first 6 rows
```
```{r, fig.height=5, fig.width=10}
# pairs(CaseData[,-c(2,3)]) # -c(column to exclude 1, column to exclude 2, and so on....) 
pairs(CaseData)
t(aggregate(MSRP~Engine.Cylinders,data=CaseData,summary))
```


### Data Prep

Filter the Data
```{r}
isEmpty <- function(column) {
    is.na(column) | column == 0 | column == "" | column == " " | column == "NA" | column == "na" | column == "Na" | column == "nA" | column == "NaN" 
}

#Filter out old cars
CaseData
CaseData %>% filter(Year > 1999) -> CaseData.NewCars.1

CaseData.NewCars = data.frame(CaseData.NewCars.1, stringsAsFactors = TRUE)

# filter Fuel.Type
CaseData.NewCars %>% filter(!isEmpty(Engine.Fuel.Type) & Engine.Fuel.Type != "natural gas") -> CaseData.NewCars.Filtered

# Summary of data before removing NA's
df <- data.frame(
  Horsepower = matrix(summary(CaseData[5])),
  Cylinders = matrix(summary(CaseData[6])),
  Doors =	matrix(summary(CaseData[9]))
)%>%
 kbl() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), font_size = 12)%>%
    add_header_above(c("Summary Data Continued" = 3))
df

# filter Engine.Hp
Vehicle.Size.Summary <- CaseData.NewCars.Filtered %>% filter(!isEmpty(Engine.HP)) %>% group_by(Vehicle.Size) %>% summarise(median_hp_by_vehicle_size=median(Engine.HP))


CaseData.NewCars.Filtered.ImpudedHP <- merge(CaseData.NewCars.Filtered, Vehicle.Size.Summary, by="Vehicle.Size") %>% mutate(Engine.HP.Clean = if_else(isEmpty(Engine.HP), median_hp_by_vehicle_size, Engine.HP))


```

```{r}
CaseDataSummary <- data.frame(
  MSRP = c(matrix(summary(CaseData[16])), "-"),
  Make = matrix(summary(CaseData[1])),
  Model =	matrix(summary(CaseData[2])),
  Year = c(matrix(summary(CaseData[3])), "-"),
  Fuel_Type = matrix(summary(CaseData[4])),
  Horsepower = matrix(summary(CaseData[5])),
  Cylinders = matrix(summary(CaseData[6])),
  Transmission =	c(matrix(summary(CaseData[7])),"-","-")
)%>%
 kbl() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), font_size = 12) %>%
    add_header_above(c("Summary Data" = 8))

CaseDataSummary2 <- data.frame(
  Driven_Wheels =	c(matrix(summary(CaseData[8])),"-","-","-"),
  Doors =	matrix(summary(CaseData[9])),
  Market_Category =	matrix(summary(CaseData[10])),
  Size = c(matrix(summary(CaseData[11])),"-","-","-","-"),
  Style =	matrix(summary(CaseData[12])),
  HWY_MPG =	c(matrix(summary(CaseData[13])),"-"),
  City_MPG = c(matrix(summary(CaseData[14])),"-"),
  Popularity = c(matrix(summary(CaseData[15])),"-")
)%>%
 kbl() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), font_size = 12)%>%
    add_header_above(c("Summary Data Continued" = 8))

CaseDataSummary
CaseDataSummary2
```